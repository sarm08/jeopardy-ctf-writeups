# Dam CTF 2020: Forensics: malware phase 1
</br>**Category:** Forensics 
</br></br>
**Description:**</br>
Welcome to the malware challenge! There are 5 phases in the scenario, can you solve them all?<br/>
After each phase gets one solve, we will release the next phase. Although they will be available to solve in any order after released, we **strongly recommend** going in order.</br>
Scenario:</br>
  As a part of your daily work at IcyRetina (one of the world's most premier cybersecurity companies), you're always finding interesting malware and exploits in client environments. Today, you're triaging an alert for some traffic at a client site that triggered one of your Snort rules (called `CLEARTEXT_ELF_LIB`). Can you find something suspicious in the PCAP?</br>
The flag for this challenge is the lowercase SHA-256 hash of the suspicious file, wrapped in `dam{...}`
</br></br>
**Attachment:** [alert.pcapng](alert.pcapng) (sha256sum: 3f92bd35d12910e9d4372ddc90d05f308a650648d3d5e613df4371c634e790b5)

## Solution
Opening alert.pcapng with Wireshark and observing the protocols used, the one that stands out is SMTP protocol, specially because this protocol deals with mail on port 25 and in this case is acting like the HTTP protocol and is using the port 587.
Folowing a TCP stream in a SMPT packet, we get:
[smtp_conversation.txt](smtp_conversation.txt) And we can see in the body of the response, that starts with `.ELF`, the signature for ELF binaries, so this must be the malware we were looking for.

Now we save it as raw in [smtp_conversation.raw](smtp_conversation.raw)

With hexeditor we delete the headers, and save the file as [malware_1](malware_1).

```
$ file malware_1
malware_1: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, BuildID[sha1]=31cb8cc7d49dbc9d6894c9f082116d2c739b8753, stripped

$ sha256sum malware_1
fc5333c5d1de963b52e57c512e10cf0e37153ac917b7040cf5f95a628a601b10
```

## Flag
> dam{fc5333c5d1de963b52e57c512e10cf0e37153ac917b7040cf5f95a628a601b10}
